---
title: "Ansioluettelo"
format: docx
output-dir: cv
execute:
  echo: false
  warning: false
---

```{r}
library(magrittr)
library(data.table)
library(gt)
library(stringr)

# quarto render aka_fi.qmd  --output-dir cv

language_select <- "fi"
date_format <- "%d.%m.%Y"


edu <- fread("data_personal/education.csv")[language == language_select]
pos <- fread("data_personal/positions.csv")[language == language_select]
grands <- fread("data_personal/grands.csv")[language == language_select]
awards <- fread("data_personal/awards.csv")[language == language_select]
other_items <- fread("data_personal/other_items.csv")[language == language_select]

make_gt_table <- function(dat_in){
  dat_in %>% 
    gt() %>% 
   fmt_markdown(columns = everything()) %>% 
  tab_options(
    table.width = pct(100),
    column_labels.hidden = TRUE,
    table.border.top.style = "hidden",
    table_body.hlines.style =  "hidden",
    table_body.border.bottom.style = "hidden"
  ) %>% 
   cols_width(
    years ~ px(120)
) %>% 
  cols_align(
    align = c("left"),
    columns = everything()
)
}

```

## Henkilotiedot ja ansioluettelon päivä

-   Sukunimi: Suokas
-   Etunimet: Kimmo Iivari
-   ORCID: [0000-0001-6296-6343](https://orcid.org/0000-0001-6296-6343), Web of Science ResearcherID [AAT-3006-2020](https://publons.com/researcher/3762591/kimmo-suokas/)
-   Ansioluettelon laatimispäivämäärä: `r format(Sys.Date(), date_format)`

## Tutkinnot ja oppiarvot

```{r}

edu[degree == TRUE] %>% 
  .[order(-end_date), .(years = paste0(end_date %>% year()), what = paste0("**", what, "**, ", institute))] %>%
  make_gt_table()
  
```

## Nykyinen työ

```{r}
pos[is.na(end_date)] %>% 
  .[,.(years = start_date %>% year(), 
      what =paste0("**", what, "**, ", where, "<br> ",
                   na.omit(details_1), ", ", format(start_date, date_format) , " alkaen", " (", osa_aikainen, ")"
                   ))] %>% 
make_gt_table()
```

### Akateeminen tutkijanuravaihe

```{r stage_academic}

other_items[aka_heading =="stage_academic"] %>%
  .[, years := ifelse(is.na(years), " ", x)] %>% 
  .[order(-end_date), .(years, what)] %>%
  make_gt_table()
```

## Aiempi työkokemus

```{r}
a <- pos[!is.na(end_date), .(years = ifelse(year(start_date) == year(end_date), year(start_date),  paste0(year(start_date), "--", year(end_date))), item = paste0("<b>",what, "</b><br>", where, "<br>", details_1))] %>% head(-6) 
b <- data.table(years = c("2011--2018"), item = paste0("**Specialising Physician** at ", pos %>% 
  tail(6) %>% 
  .$where %>% 
  paste(collapse = '; ')))

rbindlist(list(a, b)) %>% 
  make_gt_table()


```

## Tauot työuralla {.sisennys}

Taukoja työuralla perhesyistä: - 2 kk 100 % tauko , 3 kk 40 % ja 5 kk 60 % 2019 -- 2020. 5 kk 80 % tauko 2022.

## Tutkimusrahoitus ja apurahat

```{r}
grands %>% 
  .[, .(years = year, what = str_c(where, ", ", what, " ", amount, " eur"))] %>% 
make_gt_table()
```

## Tutkimuksen tuotokset
```{r research_output}
other_items[aka_heading =="research_output"] %>% 
  .[, what := str_c(sub_heading, ": ", what)] %>% 
  .[order(as.integer(end_date)), .(years, what)] %>% 
  make_gt_table()
```

## Tutkimustyön ohjaus- ja johtamiskokemus

```{r research_supervision_leadership}
other_items[aka_heading =="research_supervision_leadership"] %>%
  .[, years := ifelse(is.na(years), " ", x)] %>% 
  .[order(-end_date)] %>% 
  .[,.(years, what)] %>% 
  make_gt_table()
```

<!-- ## Opetusansiot
-->

## Palkinnot ja huomionosoitukset
```{r awards}
awards %>% 
  .[order(years), .(years, what)] %>% 
  make_gt_table()
```

## Merkittävimmät muut akateemiset ansiot
```{r other_key_academic_merits}
other_items[aka_heading =="other_key_academic_merits"] %>%
  .[order(-end_date), .(years, what = str_c(what, ", ", details_1))] %>% 
  make_gt_table()
```

## Tieteellinen ja yhteiskunnallinen vaikuttavuus
```{r impact}
other_items[aka_heading =="impact"] %>%
  .[order(-end_date), .(years, what = str_c(what, ", ", details_1))] %>% 
  make_gt_table()
```

## Muuta

Muu koulutus
```{r}
edu[degree == FALSE] %>% 
  .[order(-end_date), .(years = paste0(end_date %>% year()), what = paste0("**", what, "**, ", institute))] %>%
  make_gt_table()
```



